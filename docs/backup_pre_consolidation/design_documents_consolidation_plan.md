# 設計書統合計画 - 現在実装準拠版

**作成日**: 2025-08-27  
**目的**: docs配下の散らかった設計書を当初の01-11構成に統合し、現在の実装内容と完全一致させる  
**統合方針**: 現在の実装内容と差異が出ないよう、追加機能を含めて既存設計書に統合する  

---

## 🎯 **統合の基本方針**

### **統合原則**
1. **01-11設計書をベース維持** - 当初の11個の設計書構成を基本とする
2. **実装準拠性100%** - 現在の高品質実装内容を完全に反映
3. **情報一元化** - 重複排除と役割明確化
4. **拡張機能統合** - quality_gates、preview_interactive等の追加機能も統合

---

## 📋 **現在のファイル構成分析**

### **保持する設計書（01-11）**
| 文書番号 | ファイル名 | サイズ | 統合対象 | 統合後の役割 |
|---------|------------|--------|----------|-------------|
| 01 | ハッカソン実施計画書.md | 5.7KB | 全体実装ワークフロー | **プロジェクト統合管理書** |
| 02 | 既存サービス調査.md | 7.6KB | - | 既存のまま保持 |
| 03 | 要件定義書.md | 16.0KB | Implementation_Requirements_Analysis | **実装要件統合書** |
| 04 | システム設計書.md | 36.0KB | Backend_Implementation_Guide | **システム・実装統合書** |
| 05 | API設計書.md | 31.8KB | 拡張API仕様 | **API統合仕様書** |
| 06 | データベース設計書.md | 27.3KB | - | 既存のまま保持 |
| 07 | UI_UX設計書.md | 80.2KB | プレビュー機能設計書 | **UI/UX統合設計書** |
| 08 | AI設計書.md | 91.5KB | Phase2-7_Implementation_Strategy | **AI実装統合書** |
| 09 | インフラ設計書.md | 29.0KB | Development_Setup_Guide | **インフラ・環境統合書** |
| 10 | セキュリティ設計書.md | 40.0KB | - | 既存のまま保持 |
| 11 | テスト設計書.md | 52.7KB | - | 既存のまま保持 |

### **統合対象の追加文書**
| 追加文書 | サイズ | 統合先 | 統合理由 |
|----------|--------|--------|----------|
| **13.プレビュー機能設計書.md** | 26.2KB | → **07.UI_UX設計書** | インタラクティブUI機能として統合 |
| **Backend_Implementation_Guide.md** | 7.6KB | → **04.システム設計書** | 実装詳細として統合 |
| **Implementation_Requirements_Analysis.md** | 13.5KB | → **03.要件定義書** | 実装要件として統合 |
| **Phase2-7_Implementation_Strategy.md** | 16.3KB | → **08.AI設計書** | AIエージェント実装戦略として統合 |
| **Development_Setup_Guide.md** | 6.5KB | → **09.インフラ設計書** | 開発環境として統合 |
| **全体実装ワークフロー_統合版.md** | 36.4KB | → **01.ハッカソン実施計画書** | 実装計画として統合 |

### **整理対象フォルダ・ファイル**
- **tmp/フォルダ** → 削除（一時的ステータスファイル）
- **use-cases/フォルダ** → 03.要件定義書に統合後削除

---

## 🔧 **詳細統合計画**

### **Phase 1: 主要機能統合**

#### **01.ハッカソン実施計画書 ← 全体実装ワークフロー**
```yaml
統合内容:
  - 7フェーズHITLシステム実装戦略
  - 技術スタック詳細（実装済み）
  - プロジェクト成果・実装完了状況
  - デプロイ計画・運用準備状況
統合先: 「## 4. 実装戦略・成果」として追加
```

#### **03.要件定義書 ← Implementation_Requirements_Analysis**
```yaml
統合内容:
  - 機能要件マップ（Core Features + Preview System）
  - 実装済み機能詳細リスト
  - HITL・品質ゲート・プレビューシステム要件
統合先: 「## 4. 実装要件詳細」として追加
```

#### **04.システム設計書 ← Backend_Implementation_Guide**
```yaml
統合内容:
  - 7フェーズエージェント詳細実装仕様
  - パイプライン制御・並列処理実装
  - データスキーマ・アーキテクチャ実装
統合先: 「## 2. 実装詳細仕様」として拡充
```

### **Phase 2: 拡張機能統合**

#### **05.API設計書 ← 拡張API機能**
```yaml
統合内容:
  - Quality Gates API (5エンドポイント)
    GET /manga/{request_id}/quality-gate
    GET /manga/{request_id}/quality-report
    POST /manga/{request_id}/phase/{phase}/quality-override
    GET /quality/health
    GET /quality/metrics
  - Preview Interactive API (5エンドポイント)  
    GET /manga/{request_id}/preview/{phase}
    GET /manga/{request_id}/preview/{phase}/versions
    GET /manga/{request_id}/preview/compare
    POST /manga/{request_id}/preview/{phase}/apply-change
    POST /manga/{request_id}/preview/{phase}/revert
統合先: 「## 3.6 品質管理API」「## 3.7 インタラクティブプレビューAPI」として追加
```

#### **07.UI_UX設計書 ← プレビュー機能設計書**
```yaml
統合内容:
  - フェーズ特化型プレビューデータ構造（7フェーズ全て）
  - フル・インタラクティブ機能詳細
  - アダプティブ品質システム（5段階）
  - プレビュー履歴・比較機能
統合先: 「## 5.2 インタラクティブプレビューシステム」として拡充
```

#### **08.AI設計書 ← Phase2-7実装戦略**
```yaml
統合内容:
  - フェーズ間依存関係最適化
  - 並列処理実装詳細
  - パイプライン制御実装
  - データフロー最適化
統合先: 「## 2.3 フェーズ仕様」として拡充
```

#### **09.インフラ設計書 ← Development_Setup_Guide**
```yaml
統合内容:
  - 開発環境セットアップ手順
  - 依存関係・ツール設定
  - デバッグ・テスト環境構築
統合先: 「## 8. 開発環境構築」として追加
```

---

## 🎯 **統合後の設計書構成**

### **更新される設計書一覧**
| 設計書 | 更新内容 | 新規サイズ推定 | 主要追加内容 |
|--------|----------|---------------|-------------|
| **01.ハッカソン実施計画書** | プロジェクト実装成果統合 | ~40KB | 実装戦略・技術選定・成果報告 |
| **03.要件定義書** | 実装要件詳細統合 | ~30KB | 機能要件マップ・HITL要件 |
| **04.システム設計書** | バックエンド実装詳細統合 | ~45KB | 7エージェント実装・パイプライン |
| **05.API設計書** | 拡張API仕様統合 | ~40KB | Quality Gates + Preview APIs |
| **07.UI_UX設計書** | プレビュー機能統合 | ~110KB | インタラクティブプレビューシステム |
| **08.AI設計書** | フェーズ実装戦略統合 | ~110KB | Phase2-7詳細実装・最適化 |
| **09.インフラ設計書** | 開発環境統合 | ~35KB | セットアップ・環境構築 |

### **変更なしの設計書**
- 02.既存サービス調査.md（既存のまま）
- 06.データベース設計書.md（既存のまま）
- 10.セキュリティ設計書.md（既存のまま）
- 11.テスト設計書.md（既存のまま）

---

## 🚀 **実行手順**

### **Step 1: バックアップ作成**
```bash
mkdir docs/backup_pre_consolidation
cp docs/*.md docs/backup_pre_consolidation/
```

### **Step 2: 統合実行順序**
1. **01.ハッカソン実施計画書** ← 全体実装ワークフロー統合
2. **03.要件定義書** ← Implementation_Requirements_Analysis統合
3. **04.システム設計書** ← Backend_Implementation_Guide統合
4. **05.API設計書** ← Quality Gates + Preview Interactive APIs追加
5. **07.UI_UX設計書** ← プレビュー機能設計書統合
6. **08.AI設計書** ← Phase2-7_Implementation_Strategy統合
7. **09.インフラ設計書** ← Development_Setup_Guide統合

### **Step 3: 統合後クリーンアップ**
```bash
rm docs/13.プレビュー機能設計書.md
rm docs/Backend_Implementation_Guide.md  
rm docs/Implementation_Requirements_Analysis.md
rm docs/Phase2-7_Implementation_Strategy.md
rm docs/Development_Setup_Guide.md
rm docs/全体実装ワークフロー_統合版.md
rm -rf docs/tmp/
rm -rf docs/use-cases/ # 内容を03に統合後
```

---

## ✅ **品質保証**

### **統合後検証項目**
- [ ] 現在の実装機能（quality_gates, preview_interactive）が完全に文書化
- [ ] API仕様（12 + 10拡張 = 22エンドポイント）が完全記載
- [ ] 7フェーズエージェント実装が詳細記載
- [ ] HITLシステム・プレビュー機能が完全記載
- [ ] 重複情報なし・整合性確保

### **最終確認**
- 実装コードとの100%一致確認
- 設計書間の参照整合性確認
- バージョン番号・日付更新

---

## 📊 **期待効果**

### **統合前 → 統合後**
- **ファイル数**: 17個 → 11個（35%削減）
- **設計書構成**: 散らかり → 体系化
- **実装準拠性**: 部分的 → 100%準拠
- **保守性**: 複雑 → シンプル・明確

### **メリット**
✅ 当初の11個設計書構成に回帰  
✅ 現在の高品質実装を完全に反映  
✅ 拡張機能（quality_gates等）も正式統合  
✅ 情報一元化による保守性向上  
✅ 散らかりの完全解消  

---

## 🎯 **承認・実行**

**この統合計画により、当初の01-11設計書構成を維持しながら、現在の実装内容を100%反映した統合設計書を実現します。**

**実行承認後、段階的に統合作業を実施し、最終的にクリーンで体系的な設計書セットを完成させます。**