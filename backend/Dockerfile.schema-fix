FROM python:3.11-slim

WORKDIR /app

# Install required packages
RUN pip install asyncpg "cloud-sql-python-connector[asyncpg]" sqlalchemy

# Copy the schema fix files
COPY fix_request_id_schema.sql /app/
COPY run_schema_fix.py /app/

# Run the schema fix
CMD ["python", "run_schema_fix.py"]